{"version":3,"sources":["webpack:///src/app/pages/games/games.module.ts","webpack:///src/app/pages/games/games.component.ts","webpack:///src/app/pages/games/games.component.html"],"names":["routes","path","component","GamesModule","forChild","declarations","imports","router","GamesComponent","profile","afAuth","afs","growl","store","confirm","status","REQUESTED","gamesList","listName","filterFields","orderFields","orderReverse","rowsPerPage","timeNextMove","sub","games$","subscribe","games","load","map","game","reqTime","requestDate","getTime","canJoin","canJoinGame","canPlay","canPlayGame","console","log","loadedList","unsubscribe","newGame","then","success","showLink","open","title","htmlContent","id","token1","token2","yesButtonText","showNo","showCancel","res","deleteGame","selector","templateUrl","styleUrls"],"mappings":"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","file":"src-app-pages-games-games-module-es5.js","sourcesContent":["import {NgModule} from '@angular/core';\nimport {GamesComponent} from './games.component';\nimport {RouterModule, Routes} from '@angular/router';\nimport {CoreModule} from '@core/core.module';\n\nconst routes: Routes = [\n  { path: '', component: GamesComponent }\n];\n\n@NgModule({\n  declarations: [GamesComponent],\n  imports: [\n    CoreModule,\n    RouterModule.forChild(routes),\n  ]\n})\nexport class GamesModule { }\n\n","import {Component, OnDestroy, OnInit} from '@angular/core';\nimport {AngularFirestore} from '@angular/fire/firestore';\nimport {JbProfileService} from '@core/common/jb-profile.service';\nimport {AngularFireAuth} from '@angular/fire/auth';\nimport {JbConfirmService, JbGrowlService, JbListHandler, ListStatus} from 'jb-ui-lib';\nimport {EGameStatus, StoreService} from '@core/store/store.service';\nimport {strToDate} from '@core/core-lib/helpers';\nimport {Router} from \"@angular/router\";\n\n@Component({\n  selector: 'jb-games',\n  templateUrl: './games.component.html',\n  styleUrls: ['./games.component.scss']\n})\nexport class GamesComponent implements OnInit, OnDestroy {\n  public status = ListStatus;\n  public sub;\n  public REQUESTED = EGameStatus.REQUESTED;\n\n  public gamesList = new JbListHandler({\n    listName: 'games-list',\n    filterFields: ['playerName1', 'playerName2'],\n    orderFields: ['reqTime'],\n    orderReverse: true,\n    rowsPerPage: 10,\n    // data$: this.store.games$,\n    // status$: of(this.status.LOADED)\n  });\n\n  constructor(\n    private profile: JbProfileService,\n    private afAuth: AngularFireAuth,\n    private afs: AngularFirestore,\n    private growl: JbGrowlService,\n    public store: StoreService,\n    public router: Router,\n    private confirm: JbConfirmService,\n  ) {}\n\n  ngOnInit() {\n    this.sub = this.store.games$.subscribe(games => {\n      this.gamesList.load(games.map(game => {\n        return { ...game,\n          reqTime: strToDate(game.requestDate).getTime(),\n          canJoin: this.store.canJoinGame(game),\n          canPlay: this.store.canPlayGame(game),\n        };\n      }));\n      console.log('gamesList', this.gamesList.loadedList);\n    })\n  }\n\n  ngOnDestroy() { this.sub.unsubscribe(); }\n\n  timeNextMove = 3*24*60; // 3 days\n  newGame() {\n    this.store.newGame(this.timeNextMove).then(game => {\n      this.growl.success('view.games.request_send');\n      console.log('game', game);\n      this.showLink(game);\n    });\n  }\n\n  showLink(game) {\n    this.confirm.open({\n      title         : 'view.game.details',\n      htmlContent   : `Use this link to join as <b>Player1</b>:<br>\n                       http:\\\\\\\\127.0.0.1:4200\\\\game\\\\${game.id}\\\\${game.token1}\n                       <br>\n                       or: https://jb-chess.netlify.app?gameId=${game.id}&token=${game.token1}\n                       <br><br>\n                       Or use this link to join as <b>Player2</b>:<br>\n                       http:\\\\\\\\127.0.0.1:4200\\\\game\\\\${game.id}\\\\${game.token2}\n                       <br>\n                       or: https://jb-chess.netlify.app?gameId=${game.id}&token=${game.token2}`,\n      yesButtonText : 'view.common.ok',\n      showNo        : false,\n      showCancel    : false,\n    })\n  }\n\n\n  deleteGame(game) {\n    this.confirm.open({ title: 'Remove Game' }).then(res => {\n      if (res === 'yes') { this.store.deleteGame(game.id); }\n    })\n  }\n\n}\n","<h1 translate>view.games.title</h1>\n\n<div class=\"row whiteBg padB10\">\n  <jb-input class=\"col-md-5\"\n            jbIcon=\"icon-search\"\n            jbPlaceholder=\"view.common.search\"\n            [jbAutoFocus]=\"true\"\n            [(ngModel)]=\"gamesList.filterText\"\n            (ngModelChange)=\"gamesList.filter($event)\">\n  </jb-input>\n  <div class=\"col-md-6 marB15 text-right\">\n    <jb-btn jbType=\"add\" jbText=\"view.games.new_game\" (jbClick)=\"newGame()\"></jb-btn>\n  </div>\n  <jb-input class=\"col-md-1 flat\" [(ngModel)]=\"timeNextMove\" jbTooltip=\"New Game: Minutes timeout for every move\"></jb-input>\n</div>\n\n<div class=\"row\" [show]=\"gamesList.loadingStatus <= status.LOADING || gamesList.totalFiltered > 0\">\n  <div class=\"col-12\">\n    <ul class=\"list-unstyled table-list\">\n      <li class=\"list-header\">\n        <jb-list-header-col class=\"col-3\"  colTitle=\"view.games.request_date\" fieldName=\"reqTime\"     [orderConf]=\"gamesList.orderConf\"></jb-list-header-col>\n        <jb-list-header-col class=\"col-2\"  colTitle=\"view.common.status\"      fieldName=\"status\"      [orderConf]=\"gamesList.orderConf\"></jb-list-header-col>\n        <jb-list-header-col class=\"col-2\"  colTitle=\"view.games.player1\"      fieldName=\"playerName1\" [orderConf]=\"gamesList.orderConf\"></jb-list-header-col>\n        <jb-list-header-col class=\"col-2\"  colTitle=\"view.games.player2\"      fieldName=\"playerName2\" [orderConf]=\"gamesList.orderConf\"></jb-list-header-col>\n      </li>\n\n      <jb-list-placeholder [show]=\"gamesList.loadingStatus <= status.LOADING\" [jbColumns]=\"[3, 2, 3, 3, 1]\"></jb-list-placeholder>\n      <li class=\"list-row\" [show]=\"gamesList.loadingStatus > status.LOADING\" *ngFor=\"let game of gamesList.renderList$ | async\">\n        <div class=\"col-3\">{{game.requestDate}}</div>\n        <div class=\"col-2\">{{game.status}}</div>\n        <div class=\"col-2\">{{game.playerName1}}</div>\n        <div class=\"col-2\">{{game.playerName2}}</div>\n        <div class=\"col-3 text-right\">\n          <!--<jb-btn *ngIf=\"game.canJoin\" (jbClick)=\"joinGame(game)\"-->\n          <!--        jbType=\"add\" jbText=\"view.common.join\">-->\n          <!--</jb-btn>-->\n          <jb-btn jbType=\"delete-icon\" (jbClick)=\"deleteGame(game)\"></jb-btn>\n          <jb-btn jbType=\"view-icon\" (jbClick)=\"showLink(game)\"></jb-btn>\n          <jb-btn (jbClick)=\"router.navigate(['game/', game.id, game.token1])\"\n                  jbType=\"update\" jbText=\"view.common.go\">\n          </jb-btn>\n        </div>\n      </li>\n    </ul>\n  </div>\n</div>\n\n<div class=\"row whiteBg\" [show]=\"gamesList.totalFiltered > 5\">\n  <jb-list-paginator class=\"col-12 mobile-sm\" [jbCtrl]=\"gamesList\" jbShowSelector=\"true\"></jb-list-paginator>\n</div>\n<div class=\"row whiteBg\" [show]=\"gamesList.loadingStatus > status.LOADING && gamesList.totalFiltered === 0\">\n  <jb-no-data class=\"col-12\" [jbIsPlaceholder]=\"true\"\n              jbIcon=\"icon-finish\" jbTitle=\"view.games.no_games\">\n  </jb-no-data>\n</div>\n"]}